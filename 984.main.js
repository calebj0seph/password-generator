(()=>{"use strict";const e=function(e){return e>=48&&e<=57?"digit":e>=65&&e<=90?"uppercase":e>=97&&e<=122?"lowercase":e>=32&&e<=47||e>=58&&e<=64||e>=91&&e<=96||e>=123&&e<=126?"symbol":null},s={buffer:new Uint8Array(65536),numRead:65536};function t(){s.numRead>=s.buffer.length&&(self.crypto.getRandomValues(s.buffer),s.numRead=0);const e=s.buffer[s.numRead];return s.numRead+=1,e}function a(e,s){const a=s-e+1;let n=0;do{n=t()}while(n>Math.floor(256/a)*a-1);return n%a+e}function n(s,t){const a=new Map;for(let t=0;t<s.length;t+=1){const n=e(s.charCodeAt(t));a.has(n)?a.set(n,a.get(n)+1):a.set(n,1)}const n=a.get("digit")||0,o=a.get("symbol")||0,r=a.get("lowercase")||0,u=r+(a.get("uppercase")||0);return!(t.useDigits&&!(n/s.length>=t.minDigitProportion)||t.useSymbols&&t.symbols.length>0&&!(o/s.length>=t.minSymbolProportion)||u>0&&t.useUppercase&&t.useLowercase&&!(2*Math.abs(r/u-.5)<=t.maxCaseVariance))}function o(e,s){let t="";for(let n=0;n<e;n+=1)t+=s[a(0,s.length-1)];return t}self.addEventListener("message",(e=>{if("REQUEST_GENERATE_PASSWORD"===e.data.messageType)try{const s=function(e,s){const t=self.performance.now();let a="";e.useUppercase&&(a+="ABCDEFGHIJKLMNOPQRSTUVWXYZ"),e.useLowercase&&(a+="abcdefghijklmnopqrstuvwxyz"),e.useDigits&&(a+="0123456789"),e.useSymbols&&(a+=e.symbols);let r="";do{if(r=o(e.passwordLength,a),self.performance.now()-t>=1e3*s)return null}while(!n(r,e));return r}(e.data.messageData.options,e.data.messageData.timeout);null!==s?self.postMessage({messageType:"RESPONSE_GENERATE_PASSWORD",responseCode:"OK",messageData:{password:s,requestId:e.data.messageData.requestId}}):self.postMessage({messageType:"RESPONSE_GENERATE_PASSWORD",responseCode:"TIMEOUT",messageData:{requestId:e.data.messageData.requestId}})}catch(s){self.postMessage({messageType:"RESPONSE_GENERATE_PASSWORD",responseCode:"ERROR",messageData:{message:s.message,requestId:e.data.messageData.requestId}})}}))})();